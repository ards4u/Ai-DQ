<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Data Quality Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-shield-alt"></i>
                    <h1>DQ Dashboard</h1>
                </div>
                <nav class="nav">
                    <a href="#" class="nav-link active" data-page="dashboard">
                        <i class="fas fa-chart-line"></i> Dashboard
                    </a>
                    <a href="#" class="nav-link" data-page="weighted">
                        <i class="fas fa-balance-scale"></i> Weighted
                    </a>
                    <a href="#" class="nav-link" data-page="analysis">
                        <i class="fas fa-microscope"></i> Analysis & Insights
                    </a>
                    <a href="#" class="nav-link" data-page="csv-upload">
                        <i class="fas fa-upload"></i> CSV Upload
                    </a>
                    <a href="#" class="nav-link" data-page="rules">
                        <i class="fas fa-tasks"></i> DQ Rules
                    </a>
                    <a href="#" class="nav-link" data-page="admin">
                        <i class="fas fa-cog"></i> Admin
                    </a>
                </nav>
                <div class="llm-status" id="llmStatus">
                    <i class="fas fa-robot"></i>
                    <span id="llmStatusText">Checking...</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Page -->
        <div id="dashboardPage" class="page active">
            <div class="container">
                <div class="page-header">
                    <h2>Data Quality Overview</h2>
                    <p class="subtitle">Monitor and analyze data quality across all domains</p>
                </div>

                <!-- Domain and Sub-domain Filter Tabs -->
                <div class="filter-section" style="margin-bottom: 2rem;">
                    <div class="filter-tabs" style="display: flex; gap: 1rem; align-items: center;">
                        <button class="filter-tab active" id="domainTab" style="padding: 0.75rem 1.5rem; background: var(--primary-color); color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-layer-group"></i> Domain
                        </button>
                        <div class="sub-domain-dropdown" style="position: relative; min-width: 250px;">
                            <select id="subDomainSelect" onchange="filterBySubDomain()" style="width: 100%; padding: 0.75rem 2.5rem 0.75rem 1rem; border: 1px solid #e2e8f0; border-radius: 0.5rem; font-size: 0.95rem; appearance: none; background: white; cursor: pointer;">
                                <option value="">Sub-domain (Auto-detected)</option>
                                <!-- Populated dynamically by LLM analysis -->
                            </select>
                            <i class="fas fa-chevron-down" style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); pointer-events: none; color: #94a3b8;"></i>
                        </div>
                        <span id="domainSource" style="font-size: 0.85rem; color: #64748b; padding: 0.5rem 1rem; background: #f1f5f9; border-radius: 0.5rem;"><i class="fas fa-database"></i> Source: Database</span>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        
                        <div class="stat-content">
                            <div class="stat-label">Total Records</div>
                            <div class="stat-value" id="totalRecords"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-table"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">Data Tables</div>
                            <div class="stat-value" id="totalTables"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">Avg Quality</div>
                            <div class="stat-value" id="avgQuality"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">Issues Found</div>
                            <div class="stat-value" id="totalIssues"></div>
                        </div>
                    </div>
                </div>

                <!-- Quality by Domain & Sub-domain Chart -->
                <div class="chart-section" style="background: white; padding: 2rem; border-radius: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 2rem;">
                    <h3 style="margin-bottom: 1.5rem; color: #1e293b;">Quality by Domain & Sub-domain</h3>
                    <div class="chart-container" style="position: relative; height: 400px;">
                        <canvas id="domainQualityChart"></canvas>
                    </div>
                </div>

                <!-- Domains Section -->
                <div class="domains-section">
                    <h3>Data Domains</h3>
                    <div class="domains-grid">
                        <div class="domain-card">
                            <div class="domain-header">
                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                    <i class="fas fa-users" style="font-size: 1.5rem; color: var(--primary-color);"></i>
                                    <h4>HR</h4>
                                </div>
                                <span class="badge" style="background: #3b82f6; color: white; padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.875rem; font-weight: 600;">Owner: HR Ops · Criticality: High</span>
                            </div>
                            <p class="domain-desc">Employee master, payroll, and organization structure</p>
                            <div class="domain-score-badge" style="display: inline-block; background: #dbeafe; color: #1e40af; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 700; margin: 1rem 0;">DQ-37%</div>
                            
                            <div class="sub-domains-list" style="margin-top: 1.5rem;">
                                <div class="sub-domain-item" onclick="viewSubDomainInsights('Core HR', 90)" style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: #f8fafc; border-radius: 0.5rem; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#e2e8f0'" onmouseout="this.style.background='#f8fafc'">
                                    <span style="font-weight: 600; color: #334155;">Core HR</span>
                                    <span class="sub-domain-score" style="background: #10b981; color: white; padding: 0.25rem 0.75rem; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 600;">DQ.90%</span>
                                </div>
                                <p style="font-size: 0.875rem; color: #64748b; margin: 0.5rem 0 0.5rem 1rem;">Employee demographic and master data</p>
                                <button class="table-btn" onclick="analyzeTable('employees')" style="width: 100%; margin-bottom: 0.5rem; padding: 0.75rem; background: white; border: 1px solid #e2e8f0; border-radius: 0.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; color: #3b82f6; font-weight: 600; transition: all 0.2s;" onmouseover="this.style.background='#eff6ff'; this.style.borderColor='#3b82f6'" onmouseout="this.style.background='white'; this.style.borderColor='#e2e8f0'">
                                    <i class="fas fa-users-cog"></i> Employees Master
                                </button>
                                
                                <div class="sub-domain-item" onclick="viewSubDomainInsights('Payroll', 82)" style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: #f8fafc; border-radius: 0.5rem; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#e2e8f0'" onmouseout="this.style.background='#f8fafc'">
                                    <span style="font-weight: 600; color: #334155;">Payroll</span>
                                    <span class="sub-domain-score" style="background: #10b981; color: white; padding: 0.25rem 0.75rem; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 600;">DQ.82%</span>
                                </div>
                                <p style="font-size: 0.875rem; color: #64748b; margin: 0.5rem 0 0.5rem 1rem;">Salary, payslips, and deductions</p>
                                <button class="table-btn" onclick="analyzeTable('payroll')" style="width: 100%; margin-bottom: 0.5rem; padding: 0.75rem; background: white; border: 1px solid #e2e8f0; border-radius: 0.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; color: #3b82f6; font-weight: 600; transition: all 0.2s;" onmouseover="this.style.background='#eff6ff'; this.style.borderColor='#3b82f6'" onmouseout="this.style.background='white'; this.style.borderColor='#e2e8f0'">
                                    <i class="fas fa-money-check"></i> Payroll
                                </button>
                                <button class="table-btn" onclick="analyzeTable('tax_deductions')" style="width: 100%; margin-bottom: 0.5rem; padding: 0.75rem; background: white; border: 1px solid #e2e8f0; border-radius: 0.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; color: #3b82f6; font-weight: 600; transition: all 0.2s;" onmouseover="this.style.background='#eff6ff'; this.style.borderColor='#3b82f6'" onmouseout="this.style.background='white'; this.style.borderColor='#e2e8f0'">
                                    <i class="fas fa-file-invoice"></i> Tax Deductions
                                </button>
                            </div>
                        </div>
                        
                        <div class="domain-card">
                            <div class="domain-header">
                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                    <i class="fas fa-chart-line" style="font-size: 1.5rem; color: var(--secondary-color);"></i>
                                    <h4>Finance</h4>
                                </div>
                                <span class="badge" style="background: #10b981; color: white; padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.875rem; font-weight: 600;">Owner: Finance CoE· Criticality: High</span>
                            </div>
                            <p class="domain-desc">Financial transactions, accounting and spend analytics</p>
                            <div class="domain-score-badge" style="display: inline-block; background: #d1fae5; color: #065f46; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 700; margin: 1rem 0;">DQ-80%</div>
                            
                            <div class="sub-domains-list" style="margin-top: 1.5rem;">
                                <div class="sub-domain-item" onclick="viewSubDomainInsights('Accounts Receivable', 78)" style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: #f8fafc; border-radius: 0.5rem; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#e2e8f0'" onmouseout="this.style.background='#f8fafc'">
                                    <span style="font-weight: 600; color: #334155;">Accounts Receivable</span>
                                    <span class="sub-domain-score" style="background: #10b981; color: white; padding: 0.25rem 0.75rem; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 600;">DQ.78%</span>
                                </div>
                                <p style="font-size: 0.875rem; color: #64748b; margin: 0.5rem 0 0.5rem 1rem;">Customer invoices and collections</p>
                                <button class="table-btn" onclick="analyzeTable('invoices')" style="width: 100%; margin-bottom: 0.5rem; padding: 0.75rem; background: white; border: 1px solid #e2e8f0; border-radius: 0.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; color: #10b981; font-weight: 600; transition: all 0.2s;" onmouseover="this.style.background='#ecfdf5'; this.style.borderColor='#10b981'" onmouseout="this.style.background='white'; this.style.borderColor='#e2e8f0'">
                                    <i class="fas fa-file-invoice-dollar"></i> Invoices
                                </button>
                                
                                <div class="sub-domain-item" onclick="viewSubDomainInsights('Accounts Payable', 84)" style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: #f8fafc; border-radius: 0.5rem; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#e2e8f0'" onmouseout="this.style.background='#f8fafc'">
                                    <span style="font-weight: 600; color: #334155;">Accounts Payable</span>
                                    <span class="sub-domain-score" style="background: #10b981; color: white; padding: 0.25rem 0.75rem; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 600;">DQ.84%</span>
                                </div>
                                <p style="font-size: 0.875rem; color: #64748b; margin: 0.5rem 0 0.5rem 1rem;">Vendor invoices and expenses</p>
                                <button class="table-btn" onclick="analyzeTable('collections')" style="width: 100%; margin-bottom: 0.5rem; padding: 0.75rem; background: white; border: 1px solid #e2e8f0; border-radius: 0.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; color: #10b981; font-weight: 600; transition: all 0.2s;" onmouseover="this.style.background='#ecfdf5'; this.style.borderColor='#10b981'" onmouseout="this.style.background='white'; this.style.borderColor='#e2e8f0'">
                                    <i class="fas fa-hand-holding-usd"></i> Collections
                                </button>
                                
                                <div class="sub-domain-item" onclick="viewSubDomainInsights('Expenses', 80)" style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: #f8fafc; border-radius: 0.5rem; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#e2e8f0'" onmouseout="this.style.background='#f8fafc'">
                                    <span style="font-weight: 600; color: #334155;">Expense's</span>
                                    <span class="sub-domain-score" style="background: #10b981; color: white; padding: 0.25rem 0.75rem; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 600;">DQ.80%</span>
                                </div>
                                <button class="table-btn" onclick="analyzeTable('expenses')" style="width: 100%; margin-bottom: 0.5rem; padding: 0.75rem; background: white; border: 1px solid #e2e8f0; border-radius: 0.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; color: #10b981; font-weight: 600; transition: all 0.2s;" onmouseover="this.style.background='#ecfdf5'; this.style.borderColor='#10b981'" onmouseout="this.style.background='white'; this.style.borderColor='#e2e8f0'">
                                    <i class="fas fa-receipt"></i> Vendor Payments
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Weighted Page -->
        <div id="weightedPage" class="page">
            <div class="container">
                <div class="page-header">
                    <h2>Weighted Analysis</h2>
                    <p class="subtitle">Adjust AI-assisted metric weights and column importance</p>
                </div>
                <div class="info-banner" style="display:flex; align-items:center; gap:1rem; background:#eef2ff; border:1px solid #c7d2fe; border-radius:0.75rem; padding:1rem 1.25rem; margin-bottom:1.5rem; color:#3730a3;">
                    <i class="fas fa-wand-magic-sparkles" style="font-size:1.5rem;"></i>
                    <div>
                        <strong style="display:block; margin-bottom:0.25rem;">AI Suggested Weights</strong>
                        <p style="margin: 0; font-size: 0.9rem; color: #475569;">Weights are normalized between 0 and 1. Update them to reflect business context and click Save to refresh scoring.</p>
                    </div>
                </div>
                <div id="weightedContent" class="results-section" style="display:none"></div>
                <div id="weightedEmptyState" class="empty-state">
                    <i class="fas fa-lightbulb"></i>
                    <h3>No weights available yet</h3>
                    <p>Run an analysis or upload a CSV to generate AI-assisted weight recommendations.</p>
                </div>
                <div class="action-buttons" id="weightedActions" style="display:none">
                    <button class="btn btn-primary" id="saveWeightsBtn" onclick="saveWeightAdjustments()">
                        <i class="fas fa-save"></i> Save Weights
                    </button>
                </div>
            </div>
        </div>

        <div id="analysisPage" class="page">
            <div class="container">
                <div class="page-header">
                    <h2>Data Quality Analysis & AI Insights</h2>
                    <p class="subtitle">Comprehensive analysis with AI-powered recommendations</p>
                </div>

                <!-- Detected Domain Banner (shows after CSV upload) -->
                <div id="detectedDomainBanner" style="display:none; margin-bottom: 1.5rem; padding: 1rem 1.5rem; background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); border-radius: 0.75rem; color: white; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <i class="fas fa-magic" style="font-size: 1.5rem;"></i>
                            <div>
                                <div style="font-size: 0.85rem; opacity: 0.9;">LLM Auto-Detected Domain</div>
                                <div id="detectedDomainText" style="font-size: 1.5rem; font-weight: 700;">Finance</div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem; background: rgba(255,255,255,0.2); padding: 0.5rem 1rem; border-radius: 0.5rem;">
                            <i class="fas fa-file-csv"></i>
                            <span id="detectedFromFile" style="font-size: 0.9rem;">from uploaded CSV</span>
                        </div>
                    </div>
                </div>

                <!-- Analysis Results -->
                <div id="analysisResults" class="results-section" style="display:none">
                    <div class="results-header">
                        <h3 id="analysisTitle"></h3>
                        <div class="score-badge" id="overallScore"></div>
                    </div>

                    <!-- Score Cards -->
                    <div class="score-grid">
                        <div class="score-card">
                            <div class="score-label">Completeness</div>
                            <div class="score-value" id="completenessScore">0%</div>
                            <div class="score-bar">
                                <div class="score-fill" id="completenessFill"></div>
                            </div>
                        </div>
                        <div class="score-card">
                            <div class="score-label">Correctness</div>
                            <div class="score-value" id="correctnessScore">0%</div>
                            <div class="score-bar">
                                <div class="score-fill" id="correctnessFill"></div>
                            </div>
                        </div>
                        <div class="score-card">
                            <div class="score-label">Uniqueness</div>
                            <div class="score-value" id="uniquenessScore">0%</div>
                            <div class="score-bar">
                                <div class="score-fill" id="uniquenessFill"></div>
                            </div>
                        </div>
                        <div class="score-card">
                            <div class="score-label">Consistency</div>
                            <div class="score-value" id="consistencyScore">0%</div>
                            <div class="score-bar">
                                <div class="score-fill" id="consistencyFill"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Field Analysis Table -->
                    <div class="analysis-section">
                        <h4><i class="fas fa-table"></i> Field-Level Analysis</h4>
                        <div id="fieldAnalysisTable"></div>
                    </div>
                    <br>

                    <!-- Issues Section -->
                    <div class="analysis-section">
                        <h4><i class="fas fa-exclamation-triangle"></i> Detected Issues</h4>
                        <div id="issuesList"></div>
                    </div>
                    
                    <br>
                    <!-- AI Insights Section -->
                    <div id="aiInsightsSection" class="analysis-section" style="display:none">
                        <h4><i class="fas fa-brain"></i> AI-Generated Insights & Recommendations</h4>
                        <div id="mergedInsights"></div>
                    </div>

                    <br>
                    <!-- Action Buttons -->
                    <div class="analysis-actions">
                        <button class="btn btn-success" onclick="approveAnalysis()">
                            <i class="fas fa-check"></i> Approve Analysis
                        </button>
                        <button class="btn btn-primary" id="downloadPdfBtn" onclick="downloadAnalysisPDF()" style="display:none">
                            <i class="fas fa-download"></i> Download PDF
                        </button>
                        <button class="btn" onclick="rejectAnalysis()">
                            <i class="fas fa-times"></i> Reject
                        </button>
                    </div>
                </div>

                <br>
                <div id="noAnalysisMessage" class="empty-state">
                    <i class="fas fa-chart-bar fa-3x"></i>
                    <h3>No Analysis Available</h3>
                    <p>Click on a table from the Dashboard to view analysis</p>
                </div>
            </div>
        </div>

        <!-- CSV Upload Page -->
        <div id="csv-uploadPage" class="page">
            <div class="container">
                <div class="page-header">
                    <h2>CSV Data Upload & Analysis</h2>
                    <p class="subtitle">Upload CSV files for comprehensive data quality analysis</p>
                </div>

                <!-- Upload Section -->
                <div class="upload-section">
                    <div class="upload-card">
                        <i class="fas fa-cloud-upload-alt fa-3x" style="color: var(--primary-color); margin-bottom: 1rem;"></i>
                        <h3>Upload CSV File</h3>
                        <p>Upload your CSV file to analyze data quality with AI-powered insights</p>
                        <input type="file" id="csvFileUpload" accept=".csv" style="display:none">
                        <button class="btn btn-primary" onclick="document.getElementById('csvFileUpload').click()">
                            <i class="fas fa-upload"></i> Choose CSV File
                        </button>
                        <div id="csvFileName" class="file-name"></div>
                        <label class="checkbox-label">
                            <input type="checkbox" id="csvGenerateInsights" checked>
                            Generate AI Insights with DeepSeek-V3
                        </label>
                        <button class="btn btn-success" id="csvAnalyzeBtn" onclick="analyzeCSVFile()" style="display:none">
                            <i class="fas fa-chart-bar"></i> Analyze CSV
                        </button>
                    </div>
                </div>

                <!-- CSV Analysis Results -->
                <div id="csvAnalysisResults" class="results-section" style="display:none">
                    <!-- Results will be populated here by JavaScript -->
                </div>
            </div>
        </div>

        <!-- DQ Rules Page -->
        <div id="rulesPage" class="page">
            <div class="container">
                <div class="page-header">
                    <h2>Data Quality Rules Management</h2>
                    <p class="subtitle">Define, edit, and manage DQ rules with AI assistance</p>
                </div>

                <div class="rules-header" style="margin-bottom: 2rem; display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-primary" onclick="showCreateRuleModal()">
                            <i class="fas fa-plus"></i> Create New Rule
                        </button>
                        <button class="btn" onclick="getAISuggestionsForRules()" style="background: var(--secondary-color); color: white;">
                            <i class="fas fa-brain"></i> Get AI Suggestions
                        </button>
                    </div>
                </div>

                <!-- Dynamic Rules (Generated from Analysis) -->
                <div class="rules-grid" id="rulesGrid">
                    <div id="noRulesMessage" style="grid-column: 1/-1; text-align: center; padding: 3rem; color: #64748b;">
                        <i class="fas fa-clipboard-list" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <h4>No Dynamic Rules Generated</h4>
                        <p>Run analysis on a CSV file or database table in the "Analysis & Insights" tab to generate field-specific rules based on detected issues.</p>
                    </div>
                </div>

                <!-- AI Summary Insights Section (Below Rules) - Detailed Analysis for Each Issue -->
                <div id="aiRulesSummary" style="display:none; margin-top: 2rem; background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 100%); padding: 1.5rem; border-radius: 1rem; color: white; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
                    <h4 style="margin: 0 0 1rem 0; display: flex; align-items: center; gap: 0.5rem; font-size: 1.25rem;">
                        <i class="fas fa-brain"></i> AI Detailed Analysis - Per Issue Breakdown
                    </h4>
                    <p style="margin: 0 0 1rem 0; opacity: 0.9; font-size: 0.9rem;">Based on issues detected in the AI & Insights analysis</p>
                    <div id="aiRulesSummaryText" style="background: rgba(255,255,255,0.98); padding: 1.5rem; border-radius: 0.75rem; color: #1e293b; line-height: 1.6; max-height: 500px; overflow-y: auto;">
                        Loading detailed analysis...
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Page -->
        <div id="adminPage" class="page">
            <div class="container">
                <div class="page-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2>Administration</h2>
                        <p class="subtitle">Manage database and system settings</p>
                    </div>
                    <button onclick="backToDashboard()" class="btn" style="background: #64748b; color: white; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                </div>

                <div class="admin-grid">
                    <div class="admin-card">
                        <i class="fas fa-database"></i>
                        <h3>Database Management</h3>
                        <p>Initialize or reset the database with sample data</p>
                        <button class="btn btn-primary" onclick="initializeDatabase()">
                            <i class="fas fa-sync-alt"></i> Initialize Database
                        </button>
                    </div>
                    <div class="admin-card">
                        <i class="fas fa-robot"></i>
                        <h3>LLM Configuration</h3>
                        <p>Current Model: <strong>DeepSeek-V3 (TCS GenAI Lab)</strong></p>
                        <p>Status: <span id="adminLLMStatus">Checking...</span></p>
                    </div>
                    <div class="admin-card">
                        <i class="fas fa-shield-alt"></i>
                        <h3>Guardrails</h3>
                        <p>Security guardrails are active</p>
                        <ul style="font-size: 0.9rem; color: #64748b; text-align: left;">
                            <li>Prompt injection detection</li>
                            <li>SQL injection prevention</li>
                            <li>Input/output validation</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <p>Processing...</p>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
